import { usePanelContext } from '../../../contexts/SidebarContext';
import { useNavigation } from '../../../contexts/NavigationContext';
import ThemeToggle from '../../ui/ThemeToggle';

export default function Header() {
  const { toggleLeftPanel, toggleRightPanel } = usePanelContext();
  const { getBreadcrumb } = useNavigation();
  
  const breadcrumb = getBreadcrumb();

  return (
    <div className="flex items-center justify-between w-full px-4 md:px-7 py-5 border-b border-border bg-background theme-transition">
      {/* Left Section: Icon-Breadcrumb */}
      <div className="flex items-center gap-2 md:gap-2">
        {/* Toggle buttons group */}
        <div className="flex items-center gap-2">
          {/* Left panel toggle button */}
          <button 
            onClick={toggleLeftPanel}
            className="group p-1 hover:bg-hover rounded-lg theme-transition ease-in-out transform hover:scale-105 active:scale-95"
          >
            <div className="w-5 h-5 flex items-center justify-center">
              <svg 
                width="20" 
                height="20" 
                viewBox="0 0 20 20" 
                fill="none" 
                className="transition-transform duration-200 group-hover:scale-110 text-foreground"
              >
                <path d="M6.875 3.75V16.25H3.125C2.95924 16.25 2.80027 16.1842 2.68306 16.0669C2.56585 15.9497 2.5 15.7908 2.5 15.625V4.375C2.5 4.20924 2.56585 4.05027 2.68306 3.93306C2.80027 3.81585 2.95924 3.75 3.125 3.75H6.875Z" fill="currentColor" fillOpacity="0.1"/>
                <path d="M16.875 3.125H3.125C2.79348 3.125 2.47554 3.2567 2.24112 3.49112C2.0067 3.72554 1.875 4.04348 1.875 4.375V15.625C1.875 15.9565 2.0067 16.2745 2.24112 16.5089C2.47554 16.7433 2.79348 16.875 3.125 16.875H16.875C17.2065 16.875 17.5245 16.7433 17.7589 16.5089C17.9933 16.2745 18.125 15.9565 18.125 15.625V4.375C18.125 4.04348 17.9933 3.72554 17.7589 3.49112C17.5245 3.2567 17.2065 3.125 16.875 3.125ZM3.125 11.875H4.375C4.54076 11.875 4.69973 11.8092 4.81694 11.6919C4.93415 11.5747 5 11.4158 5 11.25C5 11.0842 4.93415 10.9253 4.81694 10.8081C4.69973 10.6908 4.54076 10.625 4.375 10.625H3.125V9.375H4.375C4.54076 9.375 4.69973 9.30915 4.81694 9.19194C4.93415 9.07473 5 8.91576 5 8.75C5 8.58424 4.93415 8.42527 4.81694 8.30806C4.69973 8.19085 4.54076 8.125 4.375 8.125H3.125V6.875H4.375C4.54076 6.875 4.69973 6.80915 4.81694 6.69194C4.93415 6.57473 5 6.41576 5 6.25C5 6.08424 4.93415 5.92527 4.81694 5.80806C4.69973 5.69085 4.54076 5.625 4.375 5.625H3.125V4.375H6.25V15.625H3.125V11.875ZM16.875 15.625H7.5V4.375H16.875V15.625Z" fill="currentColor"/>
              </svg>
            </div>
          </button>

          {/* Star/Favorites button */}
          <button className="group p-1 hover:bg-hover rounded-lg theme-transition ease-in-out transform hover:scale-105 active:scale-95">
            <div className="w-5 h-5 flex items-center justify-center">
              <svg 
                width="20" 
                height="20" 
                viewBox="0 0 20 20" 
                fill="none" 
                className="transition-transform duration-200 group-hover:scale-110 text-foreground"
              >
                <path d="M14.3851 11.5391C14.2995 11.6143 14.2358 11.7114 14.2009 11.8199C14.1659 11.9284 14.161 12.0444 14.1867 12.1555L15.2429 16.7289C15.2709 16.8484 15.263 16.9734 15.2204 17.0884C15.1777 17.2034 15.1022 17.3034 15.0031 17.3757C14.9041 17.4481 14.786 17.4898 14.6634 17.4955C14.5409 17.5012 14.4194 17.4707 14.314 17.4078L10.3218 14.986C10.2248 14.927 10.1135 14.8958 9.99998 14.8958C9.88645 14.8958 9.7751 14.927 9.6781 14.986L5.68591 17.4078C5.58058 17.4707 5.45907 17.5012 5.33654 17.4955C5.214 17.4898 5.09585 17.4481 4.99682 17.3757C4.89778 17.3034 4.82223 17.2034 4.77959 17.0884C4.73695 16.9734 4.72909 16.8484 4.75701 16.7289L5.81326 12.1555C5.83893 12.0444 5.83404 11.9284 5.7991 11.8199C5.76416 11.7114 5.70048 11.6143 5.61482 11.5391L2.0906 8.46486C1.99638 8.38478 1.92803 8.27855 1.8942 8.15961C1.86038 8.04068 1.86259 7.91438 1.90056 7.7967C1.93853 7.67902 2.01056 7.57525 2.10752 7.49852C2.20449 7.42179 2.32203 7.37554 2.44529 7.36564L7.0906 6.96407C7.20393 6.95398 7.31236 6.91314 7.40419 6.84595C7.49602 6.77877 7.56777 6.68779 7.61169 6.58282L9.42654 2.25782C9.47501 2.146 9.55512 2.0508 9.657 1.98392C9.75889 1.91704 9.8781 1.88141 9.99998 1.88141C10.1218 1.88141 10.2411 1.91704 10.3429 1.98392C10.4448 2.0508 10.5249 2.146 10.5734 2.25782L12.3883 6.58282C12.4322 6.68779 12.5039 6.77877 12.5958 6.84595C12.6876 6.91314 12.796 6.95398 12.9094 6.96407L17.5547 7.36564C17.6779 7.37554 17.7955 7.42179 17.8924 7.49852C17.9894 7.57525 18.0614 7.67902 18.0994 7.7967C18.1374 7.91438 18.1396 8.04068 18.1057 8.15961C18.0719 8.27855 18.0036 8.38478 17.9094 8.46486L14.3851 11.5391Z" fill="currentColor" fillOpacity="0.1"/>
                <path d="M18.6875 7.60081C18.6118 7.36752 18.4692 7.16164 18.2773 7.00884C18.0855 6.85603 17.8529 6.76303 17.6086 6.74143L12.9688 6.34143L11.15 2.01643C11.0553 1.78949 10.8956 1.59564 10.691 1.45929C10.4863 1.32294 10.2459 1.25018 10 1.25018C9.75411 1.25018 9.51371 1.32294 9.30907 1.45929C9.10443 1.59564 8.94471 1.78949 8.85002 2.01643L7.03674 6.34143L2.39142 6.74378C2.14614 6.76439 1.9124 6.85696 1.71952 7.00988C1.52663 7.16281 1.38319 7.36927 1.30718 7.60339C1.23117 7.83751 1.22598 8.08886 1.29225 8.32592C1.35852 8.56298 1.49331 8.7752 1.6797 8.93596L5.20392 12.0157L4.14767 16.5891C4.09182 16.8284 4.10776 17.0789 4.19349 17.3092C4.27923 17.5396 4.43095 17.7395 4.6297 17.8841C4.82845 18.0286 5.0654 18.1114 5.31093 18.122C5.55647 18.1326 5.79968 18.0706 6.01017 17.9438L9.99455 15.5219L13.9875 17.9438C14.198 18.0706 14.4412 18.1326 14.6868 18.122C14.9323 18.1114 15.1692 18.0286 15.368 17.8841C15.5667 17.7395 15.7185 17.5396 15.8042 17.3092C15.8899 17.0789 15.9059 16.8284 15.85 16.5891L14.7945 12.011L18.318 8.93596C18.5044 8.77465 18.6389 8.56183 18.7046 8.32426C18.7704 8.0867 18.7644 7.835 18.6875 7.60081ZM17.4985 7.99143L13.975 11.0664C13.8035 11.2156 13.676 11.4087 13.606 11.625C13.5361 11.8412 13.5265 12.0724 13.5781 12.2938L14.6367 16.875L10.6469 14.4532C10.4522 14.3346 10.2287 14.2719 10.0008 14.2719C9.77288 14.2719 9.54936 14.3346 9.3547 14.4532L5.37033 16.875L6.42189 12.2969C6.47357 12.0756 6.46393 11.8443 6.394 11.6281C6.32407 11.4118 6.1965 11.2187 6.02502 11.0696L2.50002 7.99612C2.49973 7.99379 2.49973 7.99143 2.50002 7.98909L7.14377 7.58753C7.37049 7.56754 7.58745 7.48604 7.77125 7.3518C7.95505 7.21757 8.09871 7.0357 8.18674 6.82581L10 2.50628L11.8125 6.82581C11.9005 7.0357 12.0442 7.21757 12.228 7.3518C12.4118 7.48604 12.6288 7.56754 12.8555 7.58753L17.5 7.98909C17.5 7.98909 17.5 7.99378 17.5 7.99456L17.4985 7.99143Z" fill="currentColor"/>
              </svg>
            </div>
          </button>
        </div>

        {/* Dynamic Breadcrumb */}
        <div className="hidden md:flex items-center gap-2 ml-2">
          {breadcrumb.map((crumb, index) => (
            <div key={index} className="flex items-center gap-2">
              <button className={`px-2 py-1 text-sm font-normal hover:bg-hover rounded-lg theme-transition ${
                index === breadcrumb.length - 1 
                  ? 'text-foreground' 
                  : 'text-muted-foreground hover:text-foreground'
              }`}>
                {crumb.label}
              </button>
              {index < breadcrumb.length - 1 && (
                <span className="text-sm font-normal text-muted-foreground opacity-50">/</span>
              )}
            </div>
          ))}
        </div>
      </div>

      {/* Right Section: Search and Actions */}
      <div className="flex items-center gap-3 md:gap-5">
        {/* Search Bar */}
        <div className="hidden sm:flex items-center gap-2 px-2 py-1 bg-card rounded-lg w-32 md:w-40 hover:bg-hover theme-transition focus-within:bg-hover focus-within:ring-2 focus-within:ring-border">
          <div className="flex items-center gap-1 flex-1">
            <div className="w-4 h-4 flex items-center justify-center">
              <img src="/src/assets/icons/search.svg" alt="Search" width="16" height="16" />
            </div>
            <span className="text-sm font-normal text-muted-foreground flex-1">Search</span>
          </div>
          <span className="text-sm font-normal text-muted-foreground hidden md:inline">âŒ˜/</span>
        </div>

        {/* Action buttons group */}
        <div className="flex items-center gap-1 md:gap-2">
          {/* Search button for mobile */}
          <button className="sm:hidden group p-1 hover:bg-hover rounded-lg theme-transition ease-in-out transform hover:scale-105 active:scale-95">
            <div className="w-5 h-5 flex items-center justify-center">
              <svg 
                width="16" 
                height="16" 
                viewBox="0 0 16 16" 
                fill="none" 
                className="transition-transform duration-200 group-hover:scale-110 text-foreground"
              >
                <path d="M14.3501 14.3562C14.2568 14.4481 14.1311 14.4998 14.0001 14.5C13.8673 14.4994 13.7398 14.448 13.6438 14.3562L10.9438 11.65C9.80671 12.6051 8.34474 13.0844 6.86285 12.9878C5.38095 12.8912 3.99355 12.2263 2.99 11.1316C1.98645 10.037 1.44424 8.59717 1.47645 7.11248C1.50867 5.62779 2.11282 4.21286 3.1629 3.16277C4.21298 2.11269 5.62791 1.50855 7.1126 1.47633C8.59729 1.44412 10.0371 1.98633 11.1317 2.98988C12.2264 3.99343 12.8913 5.38083 12.9879 6.86273C13.0845 8.34462 12.6052 9.80659 11.6501 10.9437L14.3501 13.6437C14.3973 13.6903 14.4349 13.7457 14.4605 13.8069C14.4861 13.868 14.4993 13.9337 14.4993 14C14.4993 14.0663 14.4861 14.1319 14.4605 14.1931C14.4349 14.2542 14.3973 14.3097 14.3501 14.3562ZM7.2501 12C8.18956 12 9.10792 11.7214 9.88906 11.1995C10.6702 10.6775 11.279 9.93567 11.6385 9.06772C11.998 8.19977 12.0921 7.24471 11.9088 6.3233C11.7255 5.40189 11.2732 4.55552 10.6089 3.89122C9.94455 3.22692 9.09819 2.77452 8.17678 2.59124C7.25537 2.40797 6.3003 2.50203 5.43235 2.86155C4.5644 3.22106 3.82255 3.82988 3.30062 4.61102C2.77868 5.39215 2.5001 6.31051 2.5001 7.24998C2.50175 8.50925 3.00273 9.71647 3.89317 10.6069C4.78361 11.4973 5.99083 11.9983 7.2501 12Z" fill="currentColor" fillOpacity="0.2"/>
              </svg>
            </div>
          </button>

          {/* Theme toggle */}
          <ThemeToggle />

          {/* History/Clock button */}
          <button className="hidden md:block group p-1 hover:bg-hover rounded-lg theme-transition ease-in-out transform hover:scale-105 active:scale-95">
            <div className="w-5 h-5 flex items-center justify-center">
              <svg 
                width="20" 
                height="20" 
                viewBox="0 0 20 20" 
                fill="none" 
                className="transition-transform duration-200 group-hover:scale-110 text-foreground"
              >
                <path d="M16.875 10C16.875 11.3597 16.4718 12.689 15.7164 13.8195C14.9609 14.9501 13.8872 15.8313 12.631 16.3517C11.3747 16.872 9.99238 17.0082 8.65876 16.7429C7.32514 16.4776 6.10013 15.8228 5.13864 14.8614C4.17716 13.8999 3.52238 12.6749 3.2571 11.3412C2.99183 10.0076 3.12798 8.62529 3.64833 7.36905C4.16868 6.11281 5.04987 5.03908 6.18046 4.28365C7.31105 3.52821 8.64026 3.125 10 3.125C11.8234 3.125 13.5721 3.84933 14.8614 5.13864C16.1507 6.42795 16.875 8.17664 16.875 10Z" fill="currentColor" fillOpacity="0.1"/>
                <path d="M10.625 6.25002V9.64612L13.4469 11.3391C13.589 11.4245 13.6914 11.5628 13.7316 11.7237C13.7717 11.8845 13.7463 12.0548 13.6609 12.1969C13.5756 12.339 13.4372 12.4414 13.2764 12.4816C13.1155 12.5217 12.9453 12.4963 12.8031 12.411L9.67812 10.536C9.58563 10.4804 9.50911 10.4018 9.45599 10.3079C9.40287 10.214 9.37497 10.1079 9.375 10V6.25002C9.375 6.08426 9.44085 5.92529 9.55806 5.80808C9.67527 5.69087 9.83424 5.62502 10 5.62502C10.1658 5.62502 10.3247 5.69087 10.4419 5.80808C10.5592 5.92529 10.625 6.08426 10.625 6.25002ZM10 2.50002C9.01406 2.49757 8.03742 2.69067 7.12661 3.06817C6.21579 3.44566 5.38889 4.00005 4.69375 4.69924C4.12578 5.27424 3.62109 5.82737 3.125 6.40627V5.00002C3.125 4.83426 3.05915 4.67529 2.94194 4.55808C2.82473 4.44087 2.66576 4.37502 2.5 4.37502C2.33424 4.37502 2.17527 4.44087 2.05806 4.55808C1.94085 4.67529 1.875 4.83426 1.875 5.00002V8.12502C1.875 8.29078 1.94085 8.44975 2.05806 8.56697C2.17527 8.68418 2.33424 8.75002 2.5 8.75002H5.625C5.79076 8.75002 5.94973 8.68418 6.06694 8.56697C6.18415 8.44975 6.25 8.29078 6.25 8.12502C6.25 7.95926 6.18415 7.80029 6.06694 7.68308C5.94973 7.56587 5.79076 7.50002 5.625 7.50002H3.82812C4.38672 6.84221 4.94297 6.22268 5.57734 5.58049C6.44598 4.71186 7.55133 4.11847 8.75529 3.87446C9.95924 3.63045 11.2084 3.74665 12.3467 4.20853C13.485 4.67041 14.4619 5.45749 15.1555 6.47144C15.849 7.48538 16.2283 8.68121 16.2461 9.90952C16.2639 11.1378 15.9193 12.3441 15.2554 13.3777C14.5915 14.4113 13.6377 15.2263 12.5132 15.7209C11.3888 16.2155 10.1435 16.3678 8.93299 16.1587C7.72249 15.9496 6.60043 15.3885 5.70703 14.5453C5.64732 14.4889 5.57708 14.4448 5.50032 14.4155C5.42356 14.3862 5.34179 14.3724 5.25967 14.3747C5.17754 14.377 5.09668 14.3955 5.0217 14.429C4.94672 14.4626 4.87908 14.5106 4.82266 14.5703C4.76623 14.63 4.72212 14.7003 4.69283 14.777C4.66355 14.8538 4.64967 14.9356 4.652 15.0177C4.65432 15.0998 4.67279 15.1807 4.70636 15.2557C4.73993 15.3306 4.78795 15.3983 4.84766 15.4547C5.73785 16.2948 6.82012 16.9042 8 17.2298C9.17989 17.5554 10.4215 17.5873 11.6166 17.3226C12.8116 17.058 13.9237 16.505 14.8559 15.7117C15.788 14.9184 16.5118 13.9091 16.9642 12.7718C17.4165 11.6344 17.5836 10.4037 17.4509 9.18689C17.3182 7.97011 16.8897 6.80431 16.2029 5.79122C15.516 4.77813 14.5916 3.94854 13.5104 3.37485C12.4292 2.80117 11.224 2.50082 10 2.50002Z" fill="currentColor"/>
              </svg>
            </div>
          </button>

          {/* Notifications (Bell) */}
          <button className="group p-1 hover:bg-hover rounded-lg theme-transition ease-in-out transform hover:scale-105 active:scale-95 relative">
            <div className="w-5 h-5 flex items-center justify-center">
              <svg 
                width="20" 
                height="20" 
                viewBox="0 0 20 20" 
                fill="none" 
                className="transition-transform duration-200 group-hover:scale-110 text-foreground"
              >
                <path d="M16.2499 15H3.7499C3.64051 14.9993 3.53321 14.97 3.43872 14.9149C3.34423 14.8597 3.26587 14.7808 3.21146 14.6859C3.15705 14.591 3.1285 14.4835 3.12866 14.3741C3.12883 14.2647 3.1577 14.1572 3.2124 14.0625C3.72725 13.1719 4.3749 10.9227 4.3749 8.125C4.3749 6.63316 4.96753 5.20242 6.02243 4.14752C7.07732 3.09263 8.50806 2.5 9.9999 2.5C11.4917 2.5 12.9225 3.09263 13.9774 4.14752C15.0323 5.20242 15.6249 6.63316 15.6249 8.125C15.6249 10.9234 16.2733 13.1719 16.789 14.0625C16.8437 14.1574 16.8726 14.2649 16.8727 14.3745C16.8728 14.484 16.8441 14.5916 16.7895 14.6865C16.7349 14.7815 16.6563 14.8604 16.5616 14.9154C16.4669 14.9705 16.3594 14.9996 16.2499 15Z" fill="currentColor" fillOpacity="0.1"/>
                <path d="M17.3282 13.7453C16.8946 12.9984 16.2501 10.8852 16.2501 8.125C16.2501 6.4674 15.5916 4.87769 14.4195 3.70558C13.2474 2.53348 11.6577 1.875 10.0001 1.875C8.34247 1.875 6.75276 2.53348 5.58065 3.70558C4.40855 4.87769 3.75007 6.4674 3.75007 8.125C3.75007 10.8859 3.10476 12.9984 2.67116 13.7453C2.56044 13.9352 2.50174 14.1509 2.50098 14.3707C2.50023 14.5905 2.55745 14.8066 2.66687 14.9973C2.77629 15.1879 2.93404 15.3463 3.12422 15.4565C3.31439 15.5667 3.53027 15.6248 3.75007 15.625H6.93835C7.08255 16.3306 7.46603 16.9647 8.02392 17.4201C8.58182 17.8756 9.2799 18.1243 10.0001 18.1243C10.7202 18.1243 11.4183 17.8756 11.9762 17.4201C12.5341 16.9647 12.9176 16.3306 13.0618 15.625H16.2501C16.4698 15.6247 16.6856 15.5665 16.8757 15.4562C17.0657 15.346 17.2234 15.1875 17.3327 14.9969C17.442 14.8063 17.4992 14.5903 17.4984 14.3705C17.4976 14.1508 17.4389 13.9351 17.3282 13.7453ZM10.0001 16.875C9.61243 16.8749 9.23435 16.7546 8.91788 16.5308C8.60141 16.3069 8.3621 15.9905 8.23288 15.625H11.7673C11.638 15.9905 11.3987 16.3069 11.0823 16.5308C10.7658 16.7546 10.3877 16.8749 10.0001 16.875ZM3.75007 14.375C4.35163 13.3406 5.00007 10.9438 5.00007 8.125C5.00007 6.79892 5.52686 5.52715 6.46454 4.58947C7.40222 3.65178 8.67399 3.125 10.0001 3.125C11.3262 3.125 12.5979 3.65178 13.5356 4.58947C14.4733 5.52715 15.0001 6.79892 15.0001 8.125C15.0001 10.9414 15.6469 13.3383 16.2501 14.375H3.75007Z" fill="currentColor"/>
              </svg>
            </div>
            {/* Notification indicator */}
            <div className="absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full opacity-80"></div>
          </button>

          {/* Right panel toggle */}
          <button 
            onClick={toggleRightPanel}
            className="hidden lg:block group p-1 hover:bg-hover rounded-lg theme-transition ease-in-out transform hover:scale-105 active:scale-95"
            title="Toggle right panel"
          >
            <div className="w-5 h-5 flex items-center justify-center">
              <svg 
                width="20" 
                height="20" 
                viewBox="0 0 20 20" 
                fill="none" 
                className="transition-transform duration-200 group-hover:scale-110 text-foreground"
                style={{ transform: 'scaleX(-1)' }}
              >
                <path d="M6.875 3.75V16.25H3.125C2.95924 16.25 2.80027 16.1842 2.68306 16.0669C2.56585 15.9497 2.5 15.7908 2.5 15.625V4.375C2.5 4.20924 2.56585 4.05027 2.68306 3.93306C2.80027 3.81585 2.95924 3.75 3.125 3.75H6.875Z" fill="currentColor" fillOpacity="0.1"/>
                <path d="M16.875 3.125H3.125C2.79348 3.125 2.47554 3.2567 2.24112 3.49112C2.0067 3.72554 1.875 4.04348 1.875 4.375V15.625C1.875 15.9565 2.0067 16.2745 2.24112 16.5089C2.47554 16.7433 2.79348 16.875 3.125 16.875H16.875C17.2065 16.875 17.5245 16.7433 17.7589 16.5089C17.9933 16.2745 18.125 15.9565 18.125 15.625V4.375C18.125 4.04348 17.9933 3.72554 17.7589 3.49112C17.5245 3.2567 17.2065 3.125 16.875 3.125ZM3.125 11.875H4.375C4.54076 11.875 4.69973 11.8092 4.81694 11.6919C4.93415 11.5747 5 11.4158 5 11.25C5 11.0842 4.93415 10.9253 4.81694 10.8081C4.69973 10.6908 4.54076 10.625 4.375 10.625H3.125V9.375H4.375C4.54076 9.375 4.69973 9.30915 4.81694 9.19194C4.93415 9.07473 5 8.91576 5 8.75C5 8.58424 4.93415 8.42527 4.81694 8.30806C4.69973 8.19085 4.54076 8.125 4.375 8.125H3.125V6.875H4.375C4.54076 6.875 4.69973 6.80915 4.81694 6.69194C4.93415 6.57473 5 6.41576 5 6.25C5 6.08424 4.93415 5.92527 4.81694 5.80806C4.69973 5.69085 4.54076 5.625 4.375 5.625H3.125V4.375H6.25V15.625H3.125V11.875ZM16.875 15.625H7.5V4.375H16.875V15.625Z" fill="currentColor"/>
              </svg>
            </div>
          </button>
        </div>
      </div>
    </div>
  );
}
